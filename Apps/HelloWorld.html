<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
    <title>Hello World!</title>
    <script src="https://cdn.jsdelivr.net/npm/cesium@1.104.0/Build/Cesium/Cesium.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/cesium@1.104.0/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <style>
        html, body, #cesiumContainer {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
    </style>
</head>
<body>
<div id="cesiumContainer"></div>
<script>
    Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJhNGVlMzI1MS1mNTVmLTQxNjktYWE3ZS03MDE3YzliOTM3ZDgiLCJpZCI6MjIxMzcyLCJpYXQiOjE3MTgwNzE4MjR9.M-8Kl4Es2ILgYNm59GjbbUPYwntYBx2RoWJ5eXX-Prg';

    const viewer = new Cesium.Viewer('cesiumContainer', {
        baseLayerPicker: false,
        timeline: false,
        animation: false,
        homeButton: false,
        vrButton: true,
        geocoder: false,
        sceneModePicker: false,
        navigationHelpButton: false,
        imageryProvider: new Cesium.ArcGisMapServerImageryProvider({
            url: 'https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer'
        }),
        terrainProvider: Cesium.createWorldTerrain()
    });

    viewer.scene.globe.terrainExaggeration = 1.0; // Adjusted terrain exaggeration

    var point = viewer.entities.add({
        name: "福岡市城南区七隈",
        description: "ここは福岡市城南区七隈です。",
        position: Cesium.Cartesian3.fromDegrees(130.360489, 33.529425, 900.0),
        point: {
            pixelSize: 10,
            color: Cesium.Color.BLUE,
            heightReference: Cesium.HeightReference.CLAMP_TO_GROUND
        }
    });

    function removeMarker(name) {
        var entities = viewer.entities.values;
        for (var i = 0; i < entities.length; i++) {
            var entity = entities[i];
            if (entity.name === name) {
                viewer.entities.remove(entity);
                break;
            }
        }
    }

    var kmlFiles = [
        "./kml/クエゾノ古墳群.kml", "./kml/タカバン塚古墳.kml", "./kml/羽根戸古墳群.kml", "./kml/羽根戸南古墳群.kml",
        "./kml/羽根戸南古墳群前方後円墳.kml", "./kml/卯内尺古墳群.kml", "./kml/影塚古墳群.kml", "./kml/干隈古墳群.kml",
        "./kml/京ノ隈古墳.kml", "./kml/金武古墳群.kml", "./kml/広石古墳群.kml", "./kml/広石古墳群周辺.kml", "./kml/黒塚古墳群.kml",
        "./kml/黒塔古墳群.kml", "./kml/三郎丸古墳群.kml", "./kml/山崎古墳群.kml", "./kml/四箇・重留・田村遺跡群.kml",
        "./kml/七隈古墳群.kml", "./kml/重留古墳群.kml", "./kml/小袖古墳.kml", "./kml/浄泉寺遺跡.kml",
        "./kml/神松寺御陵古墳.kml", "./kml/瀬戸口古墳群.kml", "./kml/西山古墳群.kml", "./kml/西油山古墳群.kml",
        "./kml/倉瀬戸古墳群.kml", "./kml/早苗田古墳群.kml", "./kml/太平寺古墳群.kml", "./kml/駄ヶ原古墳群.kml",
        "./kml/大谷古墳群.kml", "./kml/長峰古墳群.kml", "./kml/鳥越古墳群.kml", "./kml/東油山古墳群_牧内古墳群.kml",
        "./kml/梅林遺跡.kml", "./kml/梅林古墳.kml", "./kml/梅林八幡宮古墳.kml", "./kml/柏原K遺跡.kml",
        "./kml/柏原古墳群.kml", "./kml/白塔古墳群.kml", "./kml/飯倉E・F・G遺跡.kml", "./kml/飯倉古墳群.kml",
        "./kml/樋渡古墳.kml", "./kml/桧原古墳群.kml", "./kml/片江・桧原・太平寺製鉄・柏原M遺跡.kml", "./kml/霧ヶ滝古墳群.kml",
        "./kml/野芥・野芥大藪・飯倉H・クエゾノ遺跡群.kml", "./kml/野方古墳群.kml", "./kml/野方古墳群周辺.kml",
        "./kml/老松神社古墳群.kml", "./kml/柏原遺跡群A-Ｍ遺跡.kml", "./kml/草場古墳群・長垂山古墳群.kml", "./kml/油坂古墳群.kml"
    ];

    kmlFiles.forEach(function (kmlFile) {
        Cesium.KmlDataSource.load(kmlFile, {
            clampToGround: true
        }).then(function (dataSource) {
            viewer.dataSources.add(dataSource);
            dataSource.entities.values.forEach(function (entity) {
                if (Cesium.defined(entity.polygon)) {
                    // Adjust the polygon height based on terrain exaggeration
                    entity.polygon.heightReference = Cesium.HeightReference.CLAMP_TO_GROUND;

                    // Adjust heights if necessary
                    if (Cesium.defined(entity.polygon.height)) {
                        entity.polygon.height = entity.polygon.height * 50.0; // Adjust as needed
                    }
                    if (Cesium.defined(entity.polygon.extrudedHeight)) {
                        entity.polygon.extrudedHeight = entity.polygon.extrudedHeight * 50.0; // Adjust as needed
                    }
                }
            });
        });
    });

    viewer.zoomTo(viewer.entities);
</script>
</body>
</html>
